<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Buscar Pokémon</title>
    <style>
        .search-bar { text-align: center; margin: 20px 0; }
        .pokemon-table { width: 80%; margin: auto; border-collapse: collapse; }
        .pokemon-table th, .pokemon-table td { border: 1px solid #ccc; padding: 8px; text-align: center; }
        .pagination { text-align: center; margin: 20px 0; }
    </style>
</head>
<body>
    <h1 style="text-align:center;">Buscar Pokémon</h1>
    <div class="search-bar">
        <form th:action="@{/search-pokemon}" method="get">
            <input type="text" name="name" th:value="${name}" placeholder="Buscar por nombre..."/>
            <button type="submit">Buscar</button>
        </form>
    </div>
    <table class="pokemon-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Nombre</th>
                <th>Imagen</th>
                <th>Acción</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="pokemon : ${pokemons}">
                <td th:text="${pokemon['external_id']} ?: '-'"></td>
                <td th:text="${pokemon['name']}"></td>
                <td>
                    <img th:src="${pokemon['sprite']}" alt="sprite" width="60"/>
                </td>
                <td>
                    <form th:action="@{/add-favorite}" method="post">
                        <input type="hidden" name="userId" th:value="${userId}"/>
                        <input type="hidden" name="pokemonName" th:value="${pokemon['name']}"/>
                        <input type="hidden" name="imageUrl" th:value="${pokemon['sprite']}"/>
                        <input type="hidden" name="externalId" th:value="${pokemon['external_id']}"/>
                        <input type="hidden" name="name" th:value="${name}"/>
                        <input type="hidden" name="limit" th:value="${limit}"/>
                        <input type="hidden" name="offset" th:value="${offset}"/>
                        <button type="submit">Agregar a favoritos</button>
                    </form>
                </td>
            </tr>
        </tbody>
    </table>
    <div class="pagination">
        <form th:action="@{/search-pokemon}" method="get" style="display:inline;">
            <input type="hidden" name="name" th:value="${name}"/>
            <input type="hidden" name="limit" th:value="${limit}"/>
            <input type="hidden" name="offset" th:value="${offset - limit}" th:if="${offset - limit >= 0}"/>
            <button type="submit" th:if="${offset - limit >= 0}">Anterior</button>
        </form>
        <span>Página <span th:text="${(offset/limit)+1}"></span> de <span th:text="${(total/limit)+1}"></span></span>
        <form th:action="@{/search-pokemon}" method="get" style="display:inline;">
            <input type="hidden" name="name" th:value="${name}"/>
            <input type="hidden" name="limit" th:value="${limit}"/>
            <input type="hidden" name="offset" th:value="${offset + limit}" th:if="${offset + limit < total}"/>
            <button type="submit" th:if="${offset + limit < total}">Siguiente</button>
        </form>
    </div>
</body>
</html>
